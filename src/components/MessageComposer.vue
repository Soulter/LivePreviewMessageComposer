<template>

    <div class="message-container">

        <div class="message-edit" contenteditable="true" placeholder="Message Here😊">
            <p><br></p>

        </div>

        <div class="tool-bar">
            <ul>
                <li id="bold">
                    <span class="s">
                        <svg t="1679966947409" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2767" width="16" height="16"><path d="M362.976 804.704h141.12c79.616 0 135.776-10.24 168.384-30.784 32.64-20.48 48.96-54.496 48.96-101.984 0-47.904-15.584-82.016-46.72-102.304-31.168-20.288-85.92-30.432-164.288-30.432h-147.456v265.504z m0-345.152h132.832c60.16 0 104.768-9.728 133.76-29.12 29.056-19.456 43.552-49.44 43.552-90.048 0-38.4-13.12-67.872-39.392-88.384-26.272-20.48-64-30.752-113.12-30.752h-157.632v238.304zM545.376 896H236.48c-14.816 0-25.92-3.872-33.344-11.648-7.424-7.776-11.136-19.424-11.136-34.976 0-17.28 15.04-44.672 50.24-44.672h20.96V221.248H242.24c-32.64 0-46.4-28.928-46.4-46.624 0-15.104 3.776-26.656 11.424-34.656 7.616-8 18.624-11.968 33.024-11.968h266.336c89.824 0 158.24 17.792 205.248 53.44 47.04 35.584 70.56 87.296 70.56 155.072 0 34.112-7.2 63.904-21.6 89.376-14.4 25.472-35.84 46.4-64.192 62.816 45.76 16.832 79.744 40.32 101.984 70.56 22.24 30.24 33.376 68.64 33.376 115.264 0 39.296-9.536 75.136-28.608 107.52-19.072 32.352-45.952 58.88-80.704 79.616a232.64 232.64 0 0 1-69.28 26.24c-25.408 5.408-61.44 8.096-108.032 8.096z" fill="#000000" p-id="2768"></path></svg> 
                    </span>
                </li>

                <li id="italicize">
                    <span class="s">
                        <svg t="1679967573686" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3470" width="16" height="16"><path d="M768 128l0 64-128 0-192 576 128 0 0 64L192 832l0-64 128 0 192-576L384 192 384 128 768 128z" fill="#020202" p-id="3471"></path></svg>
                    </span>
                </li>

                <li id="underline">
                    <span class="s">
                        <svg t="1679969782620" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6381" width="16" height="16"><path d="M237.152 218.72h-10.208c-25.504 0-43.04-3.36-52.608-10.08C164.8 201.92 160 190.176 160 173.376c0-15.552 4.032-27.008 12.128-34.336 8.064-7.36 20.16-11.04 36.32-11.04h159.424c34.432 0 47.712 28.16 47.712 45.376 0 16.8-16.64 45.344-47.68 45.344h-27.456v153.28c0 46.592 2.24 80.512 6.72 101.728 4.48 21.216 11.776 40.64 21.984 58.272a155.552 155.552 0 0 0 62.176 59.84c26.56 14.304 56 21.44 88.32 21.44 60.8 0 105.12-18.08 132.96-54.176 27.84-36.16 41.76-94.528 41.76-175.168V218.72h-33.792c-33.152 0-51.52-28.16-51.52-45.344 0-17.248 8.8-45.376 36.864-45.376h171.52c15.328 0 26.88 3.776 34.752 11.328 7.872 7.584 11.808 18.912 11.808 34.048 0 16.8-4.672 28.544-14.016 35.264-9.376 6.72-26.368 10.08-51.04 10.08h-8.928v179.104c0 102.048-23.04 178.592-69.184 229.632C674.72 678.496 605.312 704 512.64 704c-83.744 0-150.592-25.504-200.544-76.544-49.952-51.04-74.944-119.808-74.944-206.336V218.72zM240 800h544a48 48 0 0 1 0 96h-544a48 48 0 0 1 0-96z" fill="#000000" p-id="6382"></path></svg>
                    </span>
                </li>

                <li id="strikethrough">
                    <span class="s">
                        <svg t="1679969696199" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5495" width="16" height="16"><path d="M272.091429 363.227429a357.741714 357.741714 0 0 1-5.851429-67.584c0-25.819429 5.851429-55.588571 17.773714-83.382858 11.849143-29.915429 29.696-57.709714 55.369143-81.554285 23.771429-23.844571 57.417143-45.714286 95.085714-61.659429A369.664 369.664 0 0 1 574.902857 43.227429c49.517714 0 97.060571 5.997714 142.628572 19.894857 35.547429 11.922286 69.193143 31.817143 98.889142 59.611428a29.696 29.696 0 0 1-1.974857 43.739429l-53.394285 49.737143c-11.922286 9.874286-29.769143 11.849143-41.618286 0a213.138286 213.138286 0 0 0-47.542857-35.84 211.675429 211.675429 0 0 0-96.914286-21.869715c-33.645714 0-63.341714 4.022857-85.138286 13.897143-21.796571 9.947429-41.545143 19.894857-55.442285 35.84-13.897143 15.872-23.698286 29.769143-29.696 45.714286a128.292571 128.292571 0 0 0-7.899429 43.739429c0 21.869714 3.949714 39.716571 9.874286 55.588571a19.602286 19.602286 0 0 1-17.773715 27.867429H291.84c-9.874286 0-17.846857-9.947429-19.748571-17.92z m550.253714 296.228571H723.382857c-13.897143 0-23.698286 13.897143-17.773714 25.819429 5.851429 11.922286 7.899429 27.794286 7.899428 43.739428 0 23.844571-5.924571 45.714286-15.872 65.609143a166.985143 166.985143 0 0 1-43.52 47.689143 203.776 203.776 0 0 1-59.392 27.794286 233.691429 233.691429 0 0 1-63.341714 9.947428 247.076571 247.076571 0 0 1-106.861714-23.844571 204.580571 204.580571 0 0 1-67.291429-49.737143 30.573714 30.573714 0 0 0-41.545143-3.949714l-55.442285 47.762285a28.891429 28.891429 0 0 0-1.974857 41.691429c27.721143 31.817143 63.341714 55.661714 104.886857 71.606857a457.508571 457.508571 0 0 0 166.253714 29.769143c43.593143 0 85.138286-5.924571 122.733714-19.821714a313.051429 313.051429 0 0 0 100.937143-55.661715 253.805714 253.805714 0 0 0 67.291429-89.453714c15.872-35.84 25.746286-73.581714 25.746285-117.321143 0-15.872 0-25.819429-1.974857-39.716571-3.949714-4.022857-11.849143-11.922286-21.796571-11.922286z m197.924571-180.882286c-3.949714-11.922286-15.798857-17.92-27.648-17.92H101.888c-13.897143 0-23.771429 5.997714-27.721143 17.92-1.974857 3.949714-1.974857 5.924571-1.974857 9.947429v59.611428c0 15.872 13.897143 31.817143 29.696 31.817143h890.733714c15.798857 0 29.622857-15.945143 29.622857-31.817143v-59.611428c0-4.022857 0-5.997714-1.974857-9.947429z" fill="#333333" p-id="5496"></path></svg>
                    </span>
                </li>

                <li id="code">
                    <span class="s">
                        <svg t="1679970430081" class="icon" viewBox="0 0 1027 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7598" width="16" height="16"><path d="M321.828571 226.742857c-14.628571-14.628571-36.571429-14.628571-51.2 0L7.314286 482.742857c-14.628571 14.628571-14.628571 36.571429 0 51.2l256 256c14.628571 14.628571 36.571429 14.628571 51.2 0 14.628571-14.628571 14.628571-36.571429 0-51.2L87.771429 512l234.057142-234.057143c7.314286-14.628571 7.314286-36.571429 0-51.2z m263.314286 0c-14.628571 0-36.571429 7.314286-43.885714 29.257143l-131.657143 497.371429c-7.314286 21.942857 7.314286 36.571429 29.257143 43.885714s36.571429-7.314286 43.885714-29.257143l131.657143-497.371429c7.314286-14.628571-7.314286-36.571429-29.257143-43.885714z m431.542857 256l-256-256c-14.628571-14.628571-36.571429-14.628571-51.2 0-14.628571 14.628571-14.628571 36.571429 0 51.2L936.228571 512l-234.057142 234.057143c-14.628571 14.628571-14.628571 36.571429 0 51.2 14.628571 14.628571 36.571429 14.628571 51.2 0l256-256c14.628571-14.628571 14.628571-43.885714 7.314285-58.514286z" fill="" p-id="7599"></path></svg>
                    </span>
                </li>

                <li id="clear">
                    <span class="s">
                        <svg t="1679970594122" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8638" width="16" height="16"><path d="M1019.475713 299.047872a51.197184 51.197184 0 0 0-29.182395-26.622535L768.097538 192.557729A145.911975 145.911975 0 0 0 679.014438 8.759838a147.44789 147.44789 0 0 0-186.869722 83.963382L269.436965 12.855613A51.197184 51.197184 0 0 0 204.928513 43.061952L138.372173 221.740124a51.197184 51.197184 0 0 0 0 39.421832 51.197184 51.197184 0 0 0 25.598592 24.574648L3.211607 728.080276a51.197184 51.197184 0 0 0 30.718311 66.044367L665.70317 1020.928169a51.197184 51.197184 0 0 0 17.407043 3.071831 51.197184 51.197184 0 0 0 48.125353-33.790142l162.807045-442.855642a51.197184 51.197184 0 0 0 14.335212 0 51.197184 51.197184 0 0 0 48.125353-33.790142l64.508452-175.606342a51.197184 51.197184 0 0 0-1.535915-38.90986zM282.748233 126.513362L504.944012 204.845054a51.197184 51.197184 0 0 0 65.532395-30.718311l16.383099-44.54155a45.053522 45.053522 0 0 1 57.340847-26.110564 44.029578 44.029578 0 0 1 25.08662 23.038733 42.493663 42.493663 0 0 1 0 32.766198l-14.847184 45.565494a51.197184 51.197184 0 0 0 30.718311 66.044367l221.683807 79.867607-30.206338 81.915495L252.541894 208.428856z m368.619725 781.26903l-129.016904-46.589438 63.996481-174.582398a51.197184 51.197184 0 1 0-96.250707-35.326057l-63.99648 175.09437-83.963382-30.206338 63.99648-174.582398a51.197184 51.197184 0 0 0-96.250706-35.326058L245.88626 761.358445 117.381328 716.816895l144.888031-394.218318L796.25599 512.028158z" fill="#3E4055" p-id="8639"></path></svg>
                    </span>

                </li>

            </ul>
        </div>
        
    </div>

    <div class="message-container" style="margin-left: 16px; padding: 16px;">
        <h1>
            Note
        </h1>
        <p>This method is constantly being refined.</p>
        <p>TODO: 1. Implement more styling 2. Fix some potential bugs 3. Efficiently convert to Markdown format</p>
    </div>

</template>

<script>
export default {
    name: 'MessageEdit',
    data() {
        return {
            message: '',
            selectedRange: null
        }
    },

    mounted() {
        console.log('mounted');
        document.querySelector('.message-edit').addEventListener('selectstart', (e) => {
            console.log(e);
        })
        document.querySelector('.message-edit').addEventListener('mouseup', (e) => {
            console.log(e);
            let selection = window.getSelection();
            let range = selection.getRangeAt(0);
            this.selectedRange = range;
            console.log(range);
        })

        document.querySelector('#bold').addEventListener('click', (e) => {
            console.log(e);
            let bold = document.createElement('b');
            bold.appendChild(this.selectedRange.extractContents());
            this.selectedRange.insertNode(bold);
        })

        document.querySelector('#italicize').addEventListener('click', (e) => {
            console.log(e);
            let italic = document.createElement('i');
            italic.appendChild(this.selectedRange.extractContents());
            this.selectedRange.insertNode(italic);
        })

        document.querySelector('#underline').addEventListener('click', (e) => {
            console.log(e);
            let underline = document.createElement('u');
            underline.appendChild(this.selectedRange.extractContents());
            this.selectedRange.insertNode(underline);
        })

        document.querySelector('#strikethrough').addEventListener('click', (e) => {
            console.log(e);
            let strikethrough = document.createElement('s');
            strikethrough.appendChild(this.selectedRange.extractContents());
            this.selectedRange.insertNode(strikethrough);
        })

        document.querySelector('#code').addEventListener('click', (e) => {
            console.log(e);
            let code = document.createElement('code');
            code.appendChild(this.selectedRange.extractContents());
            this.selectedRange.insertNode(code);
        })


        document.querySelector('#clear').addEventListener('click', (e) => {
            console.log(e);
            // 清除所有样式
            let text = this.selectedRange.extractContents();
            let textNode = document.createTextNode(text.textContent);
            this.selectedRange.insertNode(textNode);
        })
    },
}

</script>

<style>
.message-container {
    width: 700px;
    height: 200px;
    box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);
    border-radius: 5px;
}



.message-edit {
    padding: 5px;
    height: 70%;
    font-size: 16px;
}

.message-edit:focus {
    outline: #37a1f8 solid 2px;
    border-radius: 5px 5px 0 0;
}

.tool-bar {
    height: 20%;
    background-color: #f5f5f5;
    border-radius: 0 0 5px 5px;
    padding: 5px;
    
}

ul {
    list-style: none;
    padding: 0;
    margin-left: 16px;
    margin-block-start: 0;
    margin-block-end: 0;
    margin-top: 1px;
}


li {
    text-align: center;
    height: 40px;
    display: inline-block;
    margin-right: 8px;
    width: 40px;
    border-radius: 5px;
    transition: .3s;
    cursor: pointer;
}

li:hover {
    background-color: #e5e5e5;
}
    

.s {
    height: 100%; 
    display: flex; 
    align-items: center; 
    justify-content: center;
}

</style>